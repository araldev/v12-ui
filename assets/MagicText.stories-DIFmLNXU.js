import{j as w}from"./jsx-runtime-mi3Lf1GD.js";import{r as M}from"./iframe-Co4mAa2f.js";import{u as S}from"./useDataTheme-C8Cu_Mj3.js";import{c as C}from"./utils-BKj_NWD_.js";class P{canvas;ctx;particles=[];mouse=null;animationId=null;dpr;config;constructor(t,i){this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("No se pudo obtener el contexto 2D del canvas");this.ctx=e,this.dpr=window.devicePixelRatio||1,this.config=i,this.setupCanvas(),this.generateParticles(),this.animate=this.animate.bind(this),this.animate()}setupCanvas(){const t=this.canvas.getBoundingClientRect();this.canvas.width=t.width*this.dpr,this.canvas.height=t.height*this.dpr,this.canvas.style.width=`${t.width}px`,this.canvas.style.height=`${t.height}px`,this.ctx.scale(this.dpr,this.dpr),this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality&&(this.ctx.imageSmoothingQuality="high")}createTextMask(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.font=`bold ${this.config.fontSize||50}px ${this.config.fontFamily||"sans-serif"}`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=`${this.config.color||"#fff"}`,this.ctx.fillText(this.config.text,this.canvas.width/2,this.canvas.height/2),this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)}extractPositions(t){const i=[],{data:e,width:a,height:d}=t,r=Math.max(1,4);let s=0;for(let o=0;o<e.length;o+=4){const[h]=e.slice(o,o+4);h>50&&s++}const c=Math.max(1,Math.floor(Math.sqrt(s/(this.config.particles||6e3)))),n=Math.min(r,c);for(let o=0;o<d;o+=n)for(let h=0;h<a;h+=n){const m=(o*a+h)*4,[u]=e.slice(m,m+4);u>50&&i.push({x:h/this.dpr,y:o/this.dpr})}return i}generateParticles(){const t=this.createTextMask(),i=this.extractPositions(t);if(i.length===0){console.warn("No se encontraron pÃ­xeles visibles en la imagen");return}const e=Math.max(this.canvas.width,this.canvas.height)*2;this.particles=i.map(a=>({tx:a.x,ty:a.y,x:a.x+(Math.random()-.5)*e,y:a.y+(Math.random()-.5)*e,vx:0,vy:0,phase:Math.random()*Math.PI*2,age:0,isImmune:Math.random()<.05}))}updateParticle(t){const i=t.tx-t.x,e=t.ty-t.y;if(this.mouse&&this.config.attractMode){const l=this.mouse.x-t.x,r=this.mouse.y-t.y,s=Math.hypot(l,r);if(s<this.config.repulsion&&s>0){const n=10*Math.max(0,1-s/this.config.repulsion);t.vx+=l/s*n,t.vy+=r/s*n}}else if(this.mouse&&!this.config.attractMode){const l=this.mouse.x-t.x,r=this.mouse.y-t.y,s=Math.hypot(l,r);if(s<this.config.repulsion&&s>0){let c;this.config.trace?t.isImmune?c=(this.config.repulsion-s)/this.config.repulsion*.1:c=Math.max(0,1-s/this.config.repulsion):c=Math.max(0,1-s/this.config.repulsion);const n=20*c;t.vx-=l/s*n,t.vy-=r/s*n}}const a=.04,d=.73;t.vx+=i*a,t.vy+=e*a,t.vx*=d,t.vy*=d,t.x+=t.vx,t.y+=t.vy}drawParticles(){const t=this.canvas.width/this.dpr,i=this.canvas.height/this.dpr;this.ctx.clearRect(0,0,t,i);for(const e of this.particles){this.updateParticle(e),e.age+=1;const a=(Math.sin(e.phase+e.age*.15)+1)/2;this.ctx.fillStyle=this.config.color||"#fff",this.config.glow&&(this.ctx.globalAlpha=a),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,this.config.dotSize,0,Math.PI*2),this.ctx.fill()}this.ctx.globalAlpha=1}handleMouseMove=t=>{const i=this.canvas.getBoundingClientRect();this.mouse={x:(t.clientX-i.left)*(this.canvas.width/i.width),y:(t.clientY-i.top)*(this.canvas.height/i.height)}};handleMouseLeave=()=>{this.mouse=null};animate(){this.drawParticles(),this.canvas.addEventListener("mousemove",this.handleMouseMove),this.canvas.addEventListener("mouseleave",this.handleMouseLeave),this.animationId=requestAnimationFrame(this.animate)}destroy(){this.canvas.removeEventListener("mousemove",this.handleMouseMove),this.canvas.removeEventListener("mouseleave",this.handleMouseLeave),this.animationId&&cancelAnimationFrame(this.animationId)}}function x({text:f="Magic Text",particles:t=500,dotSize:i=.9,repulsion:e=50,friction:a=.82,returnSpeed:d=.01,fontFamily:l="sans-serif",fontSize:r=50,color:s,glow:c=!0,trace:n=!0,attractMode:o=!1,className:h,...m}){const{theme:u}=S(),g=s||(u==="dark"?"#fff":"#000");console.log("Theme:",u,"Color detected:",g);const y=M.useRef(null);return M.useEffect(()=>{const v=y.current;if(!v)return;if(!f){console.warn("MagicText: text needed");return}const T={text:f,particles:t,dotSize:i,repulsion:e,friction:a,returnSpeed:d,fontFamily:l,fontSize:r,color:g,glow:c,trace:n,attractMode:o},b=new P(v,T);return()=>{b&&b.destroy()}},[f,t,i,e,a,d,l,r,u,s,c,n,o]),w.jsx("canvas",{ref:y,...m,className:C("block mx-auto overflow-visible z-0 w-fit h-fit",h)})}x.__docgenInfo={description:"",methods:[],displayName:"MagicText",props:{text:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Magic Text'",computed:!1}},particles:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"500",computed:!1}},dotSize:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0.9",computed:!1}},repulsion:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"50",computed:!1}},friction:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0.82",computed:!1}},returnSpeed:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0.01",computed:!1}},fontFamily:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'sans-serif'",computed:!1}},fontSize:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"50",computed:!1}},color:{required:!1,tsType:{name:"string"},description:""},glow:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},trace:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},attractMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""}},composes:["Omit"]};const z={title:"Premium Components/MagicText",tags:["autodocs"],parameters:{layout:"fullscreen",docs:{story:{height:"100%",width:"100%"}}},component:x,argTypes:{text:{type:"string",description:"The text to display in the magic effect",control:"text",table:{category:"Config"}},particles:{type:"number",description:"Number of particles in the effect",control:"number",table:{category:"Config"}},dotSize:{type:"number",description:"Size of each particle dot",control:"number",table:{category:"Config"}},repulsion:{type:"number",description:"Repulsion force distance between mouse and particles",control:"number",table:{category:"Config"}},friction:{type:"number",description:"Friction applied to particles movement",control:"number",table:{category:"Config"}},returnSpeed:{type:"number",description:"Speed at which particles return to their original position",control:"number",table:{category:"Config"}},fontFamily:{type:"string",description:"Font family for the text",control:"text",table:{category:"Config"}},fontSize:{type:"number",description:"Font size for the text in pixels",control:"number",table:{category:"Config"}},color:{type:"string",description:"Color of the text in hex format (#RRGGBB)",control:"color",table:{category:"Config"}},glow:{type:"boolean",description:"Enable glow effect on the logo",control:"boolean",table:{category:"Effects"}},trace:{type:"boolean",description:"Enable tracing effect on the particles",control:"boolean",table:{category:"Effects"}},attractMode:{type:"boolean",description:"Enable attract mode for particles",control:"boolean",table:{category:"Effects"}},className:{type:"string",description:"Custom CSS class for additional styling",control:"text",table:{category:"Styling"}}}},p={args:{text:"Magic Text",particles:500,dotSize:.9,repulsion:50,friction:.82,returnSpeed:.01,fontFamily:"sans-serif",fontSize:50,glow:!0,trace:!0,attractMode:!1},render:f=>w.jsx(x,{...f})};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`{
  args: {
    text: 'Magic Text',
    particles: 500,
    dotSize: 0.9,
    repulsion: 50,
    friction: 0.82,
    returnSpeed: 0.01,
    fontFamily: 'sans-serif',
    fontSize: 50,
    glow: true,
    trace: true,
    attractMode: false
  },
  render: args => <MagicText {...args} />
}`,...p.parameters?.docs?.source}}};const I=["Default"];export{p as Default,I as __namedExportsOrder,z as default};
